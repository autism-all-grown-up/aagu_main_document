bold(i = (nrow(.) z- 2):nrow(.), bold = TRUE) # Make last three rows bold
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE)
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "lightgrey")
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#ddd")
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#dddddd")
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#eeeeee")
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#ffffff")
# Print the table
budget_table
library(tidyverse)
# library(knitr)
# library(kableExtra)
library(flextable)
source('utilities/utilities.R')
set_flextable_defaults(
post_process_html = autofit,
post_process_pdf = autofit,
post_process_docx = autofit
)
data <- read_csv('data/jobs_data.csv') %>%
tibble()
kable_format = switch(
ifelse(
is.null(knitr::opts_knit$get("rmarkdown.pandoc.to")),
"interactive",
knitr::opts_knit$get("rmarkdown.pandoc.to")
),
"html" = "html",
"docx" = "pipe",
"latex" = "latex",
"interactive" = "markdown"
)
phase = "seed"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 8
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#eeeeee")
# Print the table
budget_table
phase = "sprout"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 8
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#eeeeee")
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) %>%
bg(i = (nrow(budget_data) - 2):nrow(budget_data), bg = "#eeeeee")
# Print the table
budget_table
a = 10

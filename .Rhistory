headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity, "\n\n")
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n- [{trimws(Product)}]({trimws(Links)})") %>%
trimws() %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity, "\n\n")
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n- [{trimws(Product)}]({trimws(Links)})") %>%
trimws() %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity, "\n\n")
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
trimws() %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity, "\n\n")
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity, "\n\n")
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity, "\n\n")
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity)
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n\n###", entity)
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n\n##", heading, "\n\n")
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n###", entity)
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n\n##", heading)
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n\n###", entity)
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
library(openxlsx)
source("utilities/utilities.R")
funders_file = "data/Funders.xlsx"
# Get the sheet names
headings = getSheetNames(funders_file)
#| warning: false
#| message: false
#| echo: false
#| output: asis
for (heading in headings) {
cat("\n\n\n##", heading)
data = read.xlsx(funders_file, sheet = heading)
entities =
data$Entity %>%
unique() %>%
sort()
for (entity in entities)
{
cat("\n\n\n", "###", entity)
data %>%
filter(Entity == !!entity) %>%
str_glue_data("\n\n- [{trimws(Product)}]({trimws(Links)})") %>%
cat()
}
library(tidyverse)
library(kableExtra)
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format <- ifelse(is.null(output_format), "normal", output_format)
data = read_csv("data/salaries.csv") %>% rename(`Earner Class` = earner_class)
roles = data$role %>% unique() %>% sort()
#| echo: false
#| warning: false
#| message: false
for (role in roles)
{
# cat("\n\n## ", str_to_title(role), "\n\n")
salaries =
data %>%
filter(role == !!role) %>%
select(-role) %>%
kable(caption = str_to_title(role))
print(salaries)
}
?kable
library(tidyverse)
# library(gt)
source('utilities/format_budget_table.R')
source('utilities/format_staffing_table.R')
data <- read_csv('data/jobs_data.csv') %>%
tibble()
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format <- ifelse(is.null(output_format), "normal", output_format)
library(tidyverse)
library(kableExtra)
source('utilities/format_staffing_table.R')
source('utilities/format_budget_table.R')
data <- read_csv('data/jobs_data.csv') %>%
tibble()
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format <- ifelse(is.null(output_format), "normal", output_format)
n_weeks = 8
overhead = 0.1
seed_budget =
data %>%
filter(Phase == "seed") %>%
arrange(FTE) %>%
select(Responsibility, Description, FTE, Rate) %>%
### Add weekly cost per employee and overhead
mutate(
`Weekly Rate` = FTE * Rate * 40,
Overhead = `Weekly Rate` * overhead
) %>%
### Create rows for totals
rbind(
### Simple sum
summarize(.,
Responsibility = "Subtotal per Week",
Description = "",
FTE = sum(FTE),
Rate = NA,
`Weekly Rate` = sum(`Weekly Rate`),
Overhead = sum(Overhead)
),
### Add overhead and weekly rate
summarize(.,
Responsibility = "Total per Week",
Description = "",
FTE = sum(FTE),
Rate = NA,
`Weekly Rate` = sum(`Weekly Rate`)*(1 + overhead),
Overhead = NA
),
### Multiply by number of weeks
summarize(.,
Responsibility = str_glue("Total for {n_weeks} Weeks"),
Description = "",
FTE = NA,
Rate = NA,
`Weekly Rate` = sum(`Weekly Rate`)*(1 + overhead)*n_weeks,
Overhead = NA
)
# Replace NA values in numeric columns with zero and non-numeric columns with empty strings
seed_budget <- seed_budget %>%
mutate(across(where(is.numeric), ~ replace_na(., 0))) %>%
mutate(across(where(is.character), ~ replace_na(., "")))
# Determine output format
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format = ifelse(is.null(output_format), "html", output_format)
# Create the kable table
seed_budget_table <- kable(
seed_budget,
format = "html",
col.names = c("Responsibility", "Description", "FTE", "Rate", "Weekly Rate", "Overhead"),
align = c("l", "l", "r", "r", "r", "r"),
escape = FALSE
) %>%
kable_styling(
bootstrap_options = c("hover", "condensed"),
full_width = FALSE
) %>%
column_spec(1, width = "10%") %>%
column_spec(2, width = "30%") %>%
column_spec(3, width = "10%") %>%
column_spec(4, width = "10%") %>%
column_spec(5, width = "10%") %>%
column_spec(6, width = "10%")
# Print the table
seed_budget_table
library(tidyverse)
# library(gt)
source('utilities/format_budget_table.R')
source('utilities/format_staffing_table.R')
data <- read_csv('data/jobs_data.csv') %>%
tibble()
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format <- ifelse(is.null(output_format), "normal", output_format)
library(tidyverse)
library(kableExtra)
source('utilities/format_staffing_table.R')
source('utilities/format_budget_table.R')
data <- read_csv('data/jobs_data.csv') %>%
tibble()
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format <- ifelse(is.null(output_format), "normal", output_format)
n_weeks = 8
overhead = 0.1
seed_budget =
data %>%
filter(Phase == "seed") %>%
arrange(FTE) %>%
select(Responsibility, Description, FTE, Rate) %>%
### Add weekly cost per employee and overhead
mutate(
`Weekly Rate` = FTE * Rate * 40,
Overhead = `Weekly Rate` * overhead
) %>%
### Create rows for totals
rbind(
### Simple sum
summarize(.,
Responsibility = "Subtotal per Week",
Description = "",
FTE = sum(FTE),
Rate = NA,
`Weekly Rate` = sum(`Weekly Rate`),
Overhead = sum(Overhead)
),
### Add overhead and weekly rate
summarize(.,
Responsibility = "Total per Week",
Description = "",
FTE = sum(FTE),
Rate = NA,
`Weekly Rate` = sum(`Weekly Rate`)*(1 + overhead),
Overhead = NA
),
### Multiply by number of weeks
summarize(.,
Responsibility = str_glue("Total for {n_weeks} Weeks"),
Description = "",
FTE = NA,
Rate = NA,
`Weekly Rate` = sum(`Weekly Rate`)*(1 + overhead)*n_weeks,
Overhead = NA
)
# Replace NA values in numeric columns with zero and non-numeric columns with empty strings
seed_budget <- seed_budget %>%
mutate(across(where(is.numeric), ~ replace_na(., 0))) %>%
mutate(across(where(is.character), ~ replace_na(., "")))
# Determine output format
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format = ifelse(is.null(output_format), "html", output_format)
# Create the kable table
seed_budget_table <- kable(
seed_budget,
format = "html",
col.names = c("Responsibility", "Description", "FTE", "Rate", "Weekly Rate", "Overhead"),
align = c("l", "l", "r", "r", "r", "r"),
escape = FALSE
) %>%
kable_styling(
bootstrap_options = c("hover", "condensed"),
full_width = FALSE
) %>%
column_spec(1, width = "15%") %>%
column_spec(2, width = "25%") %>%
column_spec(3, width = "10%") %>%
column_spec(4, width = "10%") %>%
column_spec(5, width = "10%") %>%
column_spec(6, width = "10%")
# Print the table
seed_budget_table
library(tidyverse)
library(kableExtra)
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
output_format <- ifelse(is.null(output_format), "normal", output_format)
data = read_csv("data/salaries.csv") %>% rename(`Earner Class` = earner_class)
roles = data$role %>% unique() %>% sort()
for (role in roles) {
role_title <- str_to_title(role)
salaries <- data %>%
filter(role == !!role) %>%
select(-role)
if (output_format == "html") {
table <- kable(
salaries,
format = "html",
caption = role_title
) %>%
kable_styling(
bootstrap_options = c("hover", "condensed"),
full_width = FALSE
)
} else if (output_format == "latex") {
table <- kable(
salaries,
format = "latex",
caption = role_title,
booktabs = TRUE
) %>%
kable_styling(
latex_options = c("hold_position"),
full_width = FALSE
)
} else {
table <- kable(
salaries,
format = "pipe",
caption = role_title
)
}
print(table)
}

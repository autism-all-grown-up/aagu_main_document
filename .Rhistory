nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_num(
j = "Weekly Rate",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_num(
j = "Overhead",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
# Create the flextable
budget_table =
budget_data %>%
mutate(across(Rate, `Weekly Rate`, Overhead), ~formatC(., format = "f", digits = 2, flag = "")) %>%
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_num(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_num(
j = "Weekly Rate",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_num(
j = "Overhead",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
# Assuming budget_data is already created and contains the necessary data
# Example budget_data for demonstration
budget_data <- tibble::tribble(
~Responsibility, ~Description, ~FTE, ~Rate, ~`Weekly Rate`, ~Overhead,
"Coworking space manager", "Research how coworking spaces run. Create a budget and game plan for initial set-up. Begin planning marketing and promotion.", 0.25, 30, 300, 30,
"Research support", "Collect and organize information. Writing.", 0.25, 30, 300, 30,
"Web Development", "Design and build website.", 0.25, 30, 300, 30,
"Organizing and Directing", "Implement business systems--payrol, formal job descriptions, insurance, etc. Hold regular meetings with select partner organizations and individuals. Solicit and apply for funding for Sprout phase.", 0.75, 40, 1200, 120,
"Subtotal per Week", "", 1.5, NA, 2100, 210,
"Total per Week", "", 1.5, NA, 2310, NA,
"Total for 8 Weeks", "", NA, NA, 18480, NA
)
# Ensure numeric columns are formatted with two decimal places
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~ formatC(., format = "f", digits = 2)))
# Create the flextable with the specified formatting
budget_table <- flextable(budget_data) %>%
set_caption(caption = "Phase Budget") %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(j = "FTE", decimal.mark = ".", na_str = "", nan_str = "", prefix = "") %>%
colformat_num(j = "Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Weekly Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Overhead", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE)
# Print the table
budget_table
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~ formatC(., format = "f", digits = 2)))
# Create the flextable
budget_table =
budget_data %>%
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_num(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_num(
j = "Weekly Rate",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_num(
j = "Overhead",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
# Create the flextable
budget_table <- flextable(budget_data) %>%
set_caption(caption = "Phase Budget") %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(j = "FTE", decimal.mark = ".", na_str = "", nan_str = "", prefix = "") %>%
colformat_num(j = "Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Weekly Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Overhead", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE)
# Print the table
budget_table
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~ formatC(., format = "f", digits = 2)))
sapply(budget_data, class)
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~.*1.00))
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~.*1.00))
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~function(x) x*1.00 ))
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~.*1.00))
# Create the flextable
budget_table <- flextable(budget_data) %>%
set_caption(caption = "Phase Budget") %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(j = "FTE", decimal.mark = ".", na_str = "", nan_str = "", prefix = "") %>%
colformat_num(j = "Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Weekly Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Overhead", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE)
# Print the table
budget_table
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~round(.*1.0000001, 2)))
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~round(.*1.0000001, 2)))
budget_Data
budget_data
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
budget_data <- budget_data %>%
mutate(across(c(Rate, `Weekly Rate`, Overhead), ~round(.*1.0000001, 2)))
# Create the flextable
budget_table <- flextable(budget_data) %>%
set_caption(caption = "Phase Budget") %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(j = "FTE", decimal.mark = ".", na_str = "", nan_str = "", prefix = "") %>%
colformat_num(j = "Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Weekly Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Overhead", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE)
# Print the table
budget_table
# Create the flextable
budget_table <- flextable(budget_data) %>%
set_caption(caption = "Phase Budget") %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_num(j = "FTE", decimal.mark = ".", na_str = "", nan_str = "", prefix = "") %>%
colformat_num(j = "Rate", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Weekly Rate", big.mark = ",", decimal.mark = ",", na_str = "", nan_str = "", prefix = "$") %>%
colformat_num(j = "Overhead", big.mark = ",", decimal.mark = ".", na_str = "", nan_str = "", prefix = "$") %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE)
# Print the table
budget_table
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable()
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2)
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2)
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10.0", "20")) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10.0", "20"num)) %>% flextable() %>% colformat_(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10.0", "20"num)) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10.0", "20")) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10.0", "20")) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% mutate(Price = Price*1.0000) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% mutate(Price = Price) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c("10", "20")) %>% mutate(Price = Price*1.000) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c(10, 20)) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c(10.0, 20)) %>% flextable() %>% colformat_num(j = "Price", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c(10.0, 20)) %>% flextable() %>% colformat_double(j = "Price", decimal.mark = ".", digits=2, prefix="$")
# Create the flextable
budget_table =
budget_data %>%
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Weekly Rate",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
colformat_double(
j = "Overhead",
big_mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
tibble(Size = c("Small", "Large"), Price = c(10.0, 20)) %>% flextable() %>% colformat_double(j = "Price", big.mark=",", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c(10000.0, 200000)) %>% flextable() %>% colformat_double(j = "Price", big.mark=",", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c(10000, 200000)) %>% flextable() %>% colformat_double(j = "Price", big.mark=",", decimal.mark = ".", digits=2, prefix="$")
tibble(Size = c("Small", "Large"), Price = c(1000, 2000)) %>% flextable() %>% colformat_double(j = "Price", big.mark=",", decimal.mark = ".", digits=2, prefix="$")
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
budget_data %>% sapply(class)
# Create the flextable
budget_table =
budget_data %>%
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
budget_data %>%
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
budget_table =
budget_data %>%
flextable(budget_data)
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
budget_table =
budget_data %>%
flextable(budget_data)
budget_data
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
budget_data %>%
flextable(budget_data)
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
library(tidyverse)
# library(knitr)
# library(kableExtra)
library(flextable)
source('utilities/utilities.R')
set_flextable_defaults(
post_process_html = autofit,
post_process_pdf = autofit,
post_process_docx = autofit
)
data <- read_csv('data/jobs_data.csv') %>%
tibble()
kable_format = switch(
ifelse(
is.null(knitr::opts_knit$get("rmarkdown.pandoc.to")),
"interactive",
knitr::opts_knit$get("rmarkdown.pandoc.to")
),
"html" = "html",
"docx" = "pipe",
"latex" = "latex",
"interactive" = "markdown"
)
phase = "seed"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 8
)
# Create the flextable
budget_table <- flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%    width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box()
# Print the table
budget_table
phase = "sprout"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 8
)
# Create the flextable
budget_table <- flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%    width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box()
# Print the table
budget_table
phase = "grow"
budget_data = budget_data = calculateBudgetSummary(
data,
phase = phase,
overhead = 0.1,
n_weeks = 18
)
# Create the flextable
budget_table =
budget_data %>%
flextable(budget_data) %>%
set_caption(caption = str_glue("{str_to_title(phase)} Phase Budget")) %>%
set_table_properties(width = 1, layout = "autofit") %>%
width(j = 1, width = 1.5) %>%
width(j = 2, width = 2.5) %>%
width(j = 3, width = 1) %>%
width(j = 4, width = 1) %>%
theme_box() %>%
colformat_double(
j = "FTE",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = ""
) %>%
colformat_double(
j = "Rate",
big.mark = ",",
decimal.mark = ".",
na_str = "",
nan_str = "",
prefix = "$",
digits = 2
) %>%
bold(i = (nrow(budget_data) - 2):nrow(budget_data), bold = TRUE) # Make last three rows bold
budget_table =
budget_data %>%
flextable(budget_data)
budget_data %>% glimpse()
dim(budget_data)
